{
  "version": 3,
  "sources": ["../../../../src/transactions/data/v2.ts"],
  "sourcesContent": ["// Copyright (c) Mysten Labs, Inc.\n// Modifications Copyright (c) 2024 IOTA Stiftung\n// SPDX-License-Identifier: Apache-2.0\n\nimport type { EnumInputShape } from '@iota/bcs';\nimport type { GenericSchema, InferInput, InferOutput } from 'valibot';\nimport {\n    array,\n    boolean,\n    integer,\n    literal,\n    nullable,\n    nullish,\n    number,\n    object,\n    optional,\n    pipe,\n    record,\n    string,\n    tuple,\n    union,\n    unknown,\n} from 'valibot';\n\nimport { BCSBytes, JsonU64, ObjectID, ObjectRef, IotaAddress } from './internal.js';\n\ntype Merge<T> = T extends object ? { [K in keyof T]: T[K] } : never;\n\nfunction enumUnion<T extends Record<string, GenericSchema<any>>>(options: T) {\n    return union(\n        Object.entries(options).map(([key, value]) => object({ [key]: value })),\n    ) as GenericSchema<\n        EnumInputShape<\n            Merge<{\n                [K in keyof T]: InferInput<T[K]>;\n            }>\n        >\n    >;\n}\n\n// https://github.com/iotaledger/iota/blob/df41d5fa8127634ff4285671a01ead00e519f806/crates/iota-types/src/transaction.rs#L690-L702\nconst Argument = enumUnion({\n    GasCoin: literal(true),\n    Input: pipe(number(), integer()),\n    Result: pipe(number(), integer()),\n    NestedResult: tuple([pipe(number(), integer()), pipe(number(), integer())]),\n});\n\n// https://github.com/iotaledger/iota/blob/df41d5fa8127634ff4285671a01ead00e519f806/crates/iota-types/src/transaction.rs#L1387-L1392\nconst GasData = object({\n    budget: nullable(JsonU64),\n    price: nullable(JsonU64),\n    owner: nullable(IotaAddress),\n    payment: nullable(array(ObjectRef)),\n});\n\n// https://github.com/iotaledger/iota/blob/df41d5fa8127634ff4285671a01ead00e519f806/crates/iota-types/src/transaction.rs#L707-L718\nconst ProgrammableMoveCall = object({\n    package: ObjectID,\n    module: string(),\n    function: string(),\n    // snake case in rust\n    typeArguments: array(string()),\n    arguments: array(Argument),\n});\n\nconst $Intent = object({\n    name: string(),\n    inputs: record(string(), union([Argument, array(Argument)])),\n    data: record(string(), unknown()),\n});\n\n// https://github.com/iotaledger/iota/blob/df41d5fa8127634ff4285671a01ead00e519f806/crates/iota-types/src/transaction.rs#L657-L685\nconst Command = enumUnion({\n    MoveCall: ProgrammableMoveCall,\n    TransferObjects: object({\n        objects: array(Argument),\n        address: Argument,\n    }),\n    SplitCoins: object({\n        coin: Argument,\n        amounts: array(Argument),\n    }),\n    MergeCoins: object({\n        destination: Argument,\n        sources: array(Argument),\n    }),\n    Publish: object({\n        modules: array(BCSBytes),\n        dependencies: array(ObjectID),\n    }),\n    MakeMoveVec: object({\n        type: nullable(string()),\n        elements: array(Argument),\n    }),\n    Upgrade: object({\n        modules: array(BCSBytes),\n        dependencies: array(ObjectID),\n        package: ObjectID,\n        ticket: Argument,\n    }),\n    $Intent,\n});\n\n// https://github.com/iotaledger/iota/blob/df41d5fa8127634ff4285671a01ead00e519f806/crates/iota-types/src/transaction.rs#L102-L114\nconst ObjectArg = enumUnion({\n    ImmOrOwnedObject: ObjectRef,\n    SharedObject: object({\n        objectId: ObjectID,\n        // snake case in rust\n        initialSharedVersion: JsonU64,\n        mutable: boolean(),\n    }),\n    Receiving: ObjectRef,\n});\n\n// https://github.com/iotaledger/iota/blob/df41d5fa8127634ff4285671a01ead00e519f806/crates/iota-types/src/transaction.rs#L75-L80\nconst CallArg = enumUnion({\n    Object: ObjectArg,\n    Pure: object({\n        bytes: BCSBytes,\n    }),\n    UnresolvedPure: object({\n        value: unknown(),\n    }),\n    UnresolvedObject: object({\n        objectId: ObjectID,\n        version: optional(nullable(JsonU64)),\n        digest: optional(nullable(string())),\n        initialSharedVersion: optional(nullable(JsonU64)),\n    }),\n});\n\nconst TransactionExpiration = enumUnion({\n    None: literal(true),\n    Epoch: JsonU64,\n});\n\nexport const SerializedTransactionDataV2 = object({\n    version: literal(2),\n    sender: nullish(IotaAddress),\n    expiration: nullish(TransactionExpiration),\n    gasData: GasData,\n    inputs: array(CallArg),\n    commands: array(Command),\n});\n\nexport type SerializedTransactionDataV2 = InferOutput<typeof SerializedTransactionDataV2>;\n"],
  "mappings": "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",
  "names": []
}
